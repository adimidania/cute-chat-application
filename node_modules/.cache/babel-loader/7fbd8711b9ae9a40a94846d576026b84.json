{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\AT\\\\Downloads\\\\chat app\\\\chat-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\AT\\\\Downloads\\\\chat app\\\\chat-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\AT\\\\Downloads\\\\chat app\\\\chat-app\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useRef,useState,useEffect}from\"react\";import{useHistory}from\"react-router-dom\";import{ChatEngine}from'react-chat-engine';import{auth}from\"../firebase\";import{useAuth}from\"../contexts/AuthContext\";import axios from\"axios\";export default function Chats(){var history=useHistory();var _useAuth=useAuth(),user=_useAuth.user;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),Loading=_useState2[0],setLoading=_useState2[1];function handleLogout(){return _handleLogout.apply(this,arguments);}function _handleLogout(){_handleLogout=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return auth.signOut();case 2:history.push(\"/\");case 3:case\"end\":return _context2.stop();}}},_callee2);}));return _handleLogout.apply(this,arguments);}var getFile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return fetch(url);case 2:response=_context.sent;_context.next=5;return response.blob();case 5:data=_context.sent;return _context.abrupt(\"return\",new File([data],\"userPhoto.jpg\",{type:\"image/jpeg\"}));case 7:case\"end\":return _context.stop();}}},_callee);}));return function getFile(_x){return _ref.apply(this,arguments);};}();useEffect(function(){if(!user){history.push(\"/\");return;}axios.get(\"https://api.chatengine.io/users/me\",{headers:{\"project-id\":\"3128fea9-7ebf-4e27-9307-f1ea81a2222a\",\"user-name\":user.email,\"user-secret\":user.uid}}).then(function(){setLoading(false);}).catch(function(){var formData=new FormData();formData.append(\"email\",user.email);formData.append(\"username\",user.email);formData.append(\"secret\",user.uid);getFile(user.photoURL).then(function(avatar){formData.append(\"avatar\",avatar,avatar.name);});axios.post(\"https://api.chatengine.io/users\",formData,{headers:{\"private-key\":\"0e84e756-1687-43f6-8cef-3c323f6f5033\"}}).then(function(){return setLoading(false);}).catch(function(error){return console.log(error);});});},[user,history]);if(!user||Loading){return/*#__PURE__*/React.createElement(\"div\",{id:\"loading-container\"},/*#__PURE__*/React.createElement(\"div\",{class:\"exponea-loading-backdrop\"},/*#__PURE__*/React.createElement(\"div\",{class:\"exponea-loading-icon\"})));}return/*#__PURE__*/React.createElement(\"div\",{className:\"chats-page\"},/*#__PURE__*/React.createElement(\"div\",{className:\"nav-bar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"logo-tab\"},\"S-Chat\"),/*#__PURE__*/React.createElement(\"div\",{onClick:handleLogout,className:\"logout-tab\"},\"Logout\")),/*#__PURE__*/React.createElement(ChatEngine,{height:\"calc(100vh - 66px)\",projectID:\"3128fea9-7ebf-4e27-9307-f1ea81a2222a\",userName:user.email,userSecret:user.uid}));}","map":{"version":3,"sources":["C:/Users/AT/Downloads/chat app/chat-app/src/components/Chats.js"],"names":["React","useRef","useState","useEffect","useHistory","ChatEngine","auth","useAuth","axios","Chats","history","user","Loading","setLoading","handleLogout","signOut","push","getFile","url","fetch","response","blob","data","File","type","get","headers","email","uid","then","catch","formData","FormData","append","photoURL","avatar","name","post","error","console","log"],"mappings":"qfAAA,MAAOA,CAAAA,KAAP,EAAeC,MAAf,CAAuBC,QAAvB,CAAiCC,SAAjC,KAAiD,OAAjD,CACA,OAASC,UAAT,KAA2B,kBAA3B,CACA,OAASC,UAAT,KAA2B,mBAA3B,CACA,OAASC,IAAT,KAAqB,aAArB,CACA,OAASC,OAAT,KAAwB,yBAAxB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CAGA,cAAe,SAASC,CAAAA,KAAT,EAAiB,CAE5B,GAAMC,CAAAA,OAAO,CAAGN,UAAU,EAA1B,CACA,aAAiBG,OAAO,EAAxB,CAAQI,IAAR,UAAQA,IAAR,CACA,cAA8BT,QAAQ,CAAC,IAAD,CAAtC,wCAAOU,OAAP,eAAgBC,UAAhB,eAJ4B,QAMbC,CAAAA,YANa,8IAM5B,+JACUR,CAAAA,IAAI,CAACS,OAAL,EADV,QAEIL,OAAO,CAACM,IAAR,CAAa,GAAb,EAFJ,wDAN4B,+CAW5B,GAAMC,CAAAA,OAAO,0FAAG,iBAAOC,GAAP,0JACWC,CAAAA,KAAK,CAACD,GAAD,CADhB,QACNE,QADM,qCAEOA,CAAAA,QAAQ,CAACC,IAAT,EAFP,QAENC,IAFM,+CAGL,GAAIC,CAAAA,IAAJ,CAAS,CAACD,IAAD,CAAT,CAAiB,eAAjB,CAAkC,CAACE,IAAI,CAAG,YAAR,CAAlC,CAHK,wDAAH,kBAAPP,CAAAA,OAAO,4CAAb,CAKAd,SAAS,CAAC,UAAM,CACZ,GAAG,CAACQ,IAAJ,CAAU,CACND,OAAO,CAACM,IAAR,CAAa,GAAb,EACA,OACH,CACDR,KAAK,CAACiB,GAAN,CAAU,oCAAV,CAAgD,CAC5CC,OAAO,CAAE,CACL,aAAe,sCADV,CAEL,YAAcf,IAAI,CAACgB,KAFd,CAGL,cAAgBhB,IAAI,CAACiB,GAHhB,CADmC,CAAhD,EAOCC,IAPD,CAOM,UAAM,CACRhB,UAAU,CAAC,KAAD,CAAV,CACH,CATD,EAUCiB,KAVD,CAUO,UAAM,CACT,GAAIC,CAAAA,QAAQ,CAAG,GAAIC,CAAAA,QAAJ,EAAf,CACAD,QAAQ,CAACE,MAAT,CAAgB,OAAhB,CAAyBtB,IAAI,CAACgB,KAA9B,EACAI,QAAQ,CAACE,MAAT,CAAgB,UAAhB,CAA4BtB,IAAI,CAACgB,KAAjC,EACAI,QAAQ,CAACE,MAAT,CAAgB,QAAhB,CAA0BtB,IAAI,CAACiB,GAA/B,EACAX,OAAO,CAACN,IAAI,CAACuB,QAAN,CAAP,CACCL,IADD,CACM,SAACM,MAAD,CAAY,CACdJ,QAAQ,CAACE,MAAT,CAAgB,QAAhB,CAA0BE,MAA1B,CAAkCA,MAAM,CAACC,IAAzC,EACH,CAHD,EAIA5B,KAAK,CAAC6B,IAAN,CAAW,iCAAX,CACIN,QADJ,CAEI,CAAEL,OAAO,CAAE,CAAE,cAAe,sCAAjB,CAAX,CAFJ,EAICG,IAJD,CAKI,iBAAMhB,CAAAA,UAAU,CAAC,KAAD,CAAhB,EALJ,EAOCiB,KAPD,CAQI,SAACQ,KAAD,QAAWC,CAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAAX,EARJ,EAUH,CA7BD,EA+BH,CApCQ,CAoCN,CAAC3B,IAAD,CAAOD,OAAP,CApCM,CAAT,CAsCA,GAAG,CAACC,IAAD,EAASC,OAAZ,CAAsB,CAClB,mBACI,2BAAK,EAAE,CAAC,mBAAR,eACI,2BAAK,KAAK,CAAC,0BAAX,eACI,2BAAK,KAAK,CAAC,sBAAX,EADJ,CADJ,CADJ,CAOH,CAED,mBACI,2BAAK,SAAS,CAAC,YAAf,eACI,2BAAK,SAAS,CAAC,SAAf,eACI,2BAAK,SAAS,CAAC,UAAf,WADJ,cAKI,2BAAK,OAAO,CAAEE,YAAd,CAA4B,SAAS,CAAC,YAAtC,WALJ,CADJ,cAWI,oBAAC,UAAD,EACI,MAAM,CAAC,oBADX,CAEI,SAAS,CAAE,sCAFf,CAGI,QAAQ,CAAEH,IAAI,CAACgB,KAHnB,CAII,UAAU,CAAEhB,IAAI,CAACiB,GAJrB,EAXJ,CADJ,CAoBH","sourcesContent":["import React, {useRef, useState, useEffect} from \"react\"\r\nimport { useHistory } from \"react-router-dom\"\r\nimport { ChatEngine } from 'react-chat-engine'\r\nimport { auth } from \"../firebase\"\r\nimport { useAuth } from \"../contexts/AuthContext\"\r\nimport axios from \"axios\"\r\n\r\n\r\nexport default function Chats() {\r\n\r\n    const history = useHistory();\r\n    const { user } = useAuth();\r\n    const [Loading, setLoading] = useState(true)\r\n\r\n    async function handleLogout() {\r\n        await auth.signOut()\r\n        history.push(\"/\")\r\n    }\r\n    \r\n    const getFile = async (url) => {\r\n        const response = await fetch(url)\r\n        const data = await response.blob()\r\n        return new File([data], \"userPhoto.jpg\", {type : \"image/jpeg\"})\r\n    }\r\n    useEffect(() => {\r\n        if(!user) {\r\n            history.push(\"/\")\r\n            return;\r\n        }\r\n        axios.get(\"https://api.chatengine.io/users/me\", {\r\n            headers: {\r\n                \"project-id\" : \"3128fea9-7ebf-4e27-9307-f1ea81a2222a\",\r\n                \"user-name\" : user.email,\r\n                \"user-secret\" : user.uid,\r\n            }\r\n        })\r\n        .then(() => {\r\n            setLoading(false)\r\n        })\r\n        .catch(() => {\r\n            let formData = new FormData();\r\n            formData.append(\"email\", user.email);\r\n            formData.append(\"username\", user.email);\r\n            formData.append(\"secret\", user.uid);\r\n            getFile(user.photoURL)\r\n            .then((avatar) => {\r\n                formData.append(\"avatar\", avatar, avatar.name)\r\n            })\r\n            axios.post(\"https://api.chatengine.io/users\",\r\n                formData,\r\n                { headers: { \"private-key\": \"0e84e756-1687-43f6-8cef-3c323f6f5033\"}}\r\n            )\r\n            .then(\r\n                () => setLoading(false)\r\n            )\r\n            .catch(\r\n                (error) => console.log(error)\r\n            )\r\n        })\r\n\r\n    }, [user, history])\r\n\r\n    if(!user || Loading ) {\r\n        return (\r\n            <div id=\"loading-container\">\r\n                <div class=\"exponea-loading-backdrop\">\r\n                    <div class=\"exponea-loading-icon\"></div>\r\n                </div>\r\n            </div>\r\n        )\r\n    }\r\n    \r\n    return (\r\n        <div className='chats-page'>\r\n            <div className='nav-bar'>\r\n                <div className='logo-tab'>\r\n                S-Chat\r\n                </div>\r\n\r\n                <div onClick={handleLogout} className='logout-tab'>\r\n                    Logout\r\n                </div>\r\n            </div>\r\n\r\n            <ChatEngine \r\n                height='calc(100vh - 66px)'\r\n                projectID= \"3128fea9-7ebf-4e27-9307-f1ea81a2222a\"\r\n                userName={user.email}\r\n                userSecret={user.uid}\r\n            />\r\n        </div>\r\n    )\r\n}"]},"metadata":{},"sourceType":"module"}